<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd"> 
<html>
  <head>
    <title>instant JavaScript code formatter</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta>
    <style type="text/css"><!--
      textarea {
        font-family: monospace;
        white-space: pre-wrap;
        width: 80%;
      }
      pre {
        border: 1px solid #a3a3a3;
        width: 80%;
      }
    --></style>
    <script type="text/javascript"><!--
      function prettify(source) {
        var fun;
        try {
          fun = new Function(source);
        } catch (error if error instanceof SyntaxError) {
          return null;
        }
        return fun.toSource(0).
          split('\n').
          slice(1, -1).
          join('\n').
          replace(/^\s{4}/gm, '');
      }
      document.addEventListener("DOMContentLoaded", function (e) {
        var source = document.getElementsByTagName('textarea').item(0);
        var button = document.getElementsByTagName('input').item(0);
        var pre = document.getElementsByTagName('pre').item(0);
        button.addEventListener(
          'click',
          function () {
            pre.textContent = prettify(source.value) || 'syntax error';
          },
          false
        );
      }, false);
    --></script>
  </head>
  <body>
    <p>
      <textarea rows="30" cols="78"></textarea>
      <input type="button" value="整形">
    </p>
    <pre>
    </pre>
  </body>
</html>
